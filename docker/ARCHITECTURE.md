# AdminApp Architecture

## System Overview

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              INTERNET                                            │
│                                  │                                               │
│                    https://adminpanel.temcobank.com                              │
└─────────────────────────────────────────────────────────────────────────────────┘
                                   │
                                   ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                     PRODUCTION SERVER (109.123.227.166)                          │
│  ┌───────────────────────────────────────────────────────────────────────────┐  │
│  │                         HOST NGINX (SSL Termination)                       │  │
│  │                                                                            │  │
│  │   ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────────────┐   │  │
│  │   │ adminpanel.     │  │ my.temcobank.   │  │ lending.temcobank.      │   │  │
│  │   │ temcobank.com   │  │ com             │  │ com                     │   │  │
│  │   │     :443        │  │     :443        │  │     :443                │   │  │
│  │   └────────┬────────┘  └────────┬────────┘  └────────┬────────────────┘   │  │
│  │            │                    │                    │                    │  │
│  │            ▼                    ▼                    ▼                    │  │
│  │      localhost:8089       localhost:8082       localhost:8080             │  │
│  └───────────────────────────────────────────────────────────────────────────┘  │
│                                   │                                              │
│  ┌────────────────────────────────┼──────────────────────────────────────────┐  │
│  │                    DOCKER ENVIRONMENT                                      │  │
│  │                                │                                           │  │
│  │   ┌────────────────────────────┴────────────────────────────────────────┐ │  │
│  │   │                     ADMIN APP (Isolated)                             │ │  │
│  │   │                                                                      │ │  │
│  │   │  ┌──────────────────────┐      ┌──────────────────────────────────┐ │ │  │
│  │   │  │  admin-frontend      │      │      admin-wildfly               │ │ │  │
│  │   │  │  (nginx:alpine)      │      │   (WildFly 31 + JDK17)           │ │ │  │
│  │   │  │                      │      │                                  │ │ │  │
│  │   │  │  ┌────────────────┐  │      │  ┌────────────────────────────┐  │ │ │  │
│  │   │  │  │  Vue.js SPA    │  │      │  │   temco-admin.war          │  │ │ │  │
│  │   │  │  │  (Static HTML) │  │ API  │  │   Jakarta EE 10            │  │ │ │  │
│  │   │  │  │                │──┼──────┼──│   - REST API               │  │ │ │  │
│  │   │  │  │  /assets/*     │  │      │  │   - JPA/Hibernate          │  │ │ │  │
│  │   │  │  │  /index.html   │  │      │  │   - JWT Auth               │  │ │ │  │
│  │   │  │  └────────────────┘  │      │  │   - Email Service          │  │ │ │  │
│  │   │  │                      │      │  └────────────────────────────┘  │ │ │  │
│  │   │  │  Port: 80 → 8089     │      │  Port: 8080 → 8085               │ │ │  │
│  │   │  └──────────────────────┘      └──────────────┬───────────────────┘ │ │  │
│  │   │                                               │                      │ │  │
│  │   └───────────────────────────────────────────────┼──────────────────────┘ │  │
│  │                                                   │                        │  │
│  │   ┌───────────────────────────────────────────────┼──────────────────────┐ │  │
│  │   │              OTHER APPS (Customer Portal, Lending)                   │ │  │
│  │   │                                               │                      │ │  │
│  │   │  ┌──────────────────┐  ┌──────────────────┐   │                      │ │  │
│  │   │  │ customer-portal  │  │  lending-app     │   │                      │ │  │
│  │   │  │    :8082         │  │    :8080         │   │                      │ │  │
│  │   │  └──────────────────┘  └──────────────────┘   │                      │ │  │
│  │   └───────────────────────────────────────────────┼──────────────────────┘ │  │
│  └───────────────────────────────────────────────────┼──────────────────────────┘  │
│                                                      │                              │
│                                          ┌───────────┴───────────┐                 │
│                                          │  172.17.0.1:3306      │                 │
│                                          │  (Docker Gateway)     │                 │
│                                          └───────────┬───────────┘                 │
│                                                      │                              │
│  ┌───────────────────────────────────────────────────┴──────────────────────────┐  │
│  │                            HOST MARIADB                                       │  │
│  │                                                                               │  │
│  │   ┌─────────────────────────────────────────────────────────────────────┐    │  │
│  │   │                      MariaDB 10.6.23                                 │    │  │
│  │   │                      bind-address: 0.0.0.0                           │    │  │
│  │   │                      Port: 3306                                      │    │  │
│  │   │                                                                      │    │  │
│  │   │   ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────────┐ │    │  │
│  │   │   │  temco_system   │  │  admin_callingDB│  │  Other DBs...       │ │    │  │
│  │   │   │  (Main DB)      │  │                 │  │                     │ │    │  │
│  │   │   └─────────────────┘  └─────────────────┘  └─────────────────────┘ │    │  │
│  │   └─────────────────────────────────────────────────────────────────────┘    │  │
│  └──────────────────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

## Data Flow

```
┌──────────┐     HTTPS      ┌────────────┐     HTTP      ┌───────────────┐
│  Browser │ ──────────────▶│ Host Nginx │ ────────────▶ │ admin-frontend│
│          │                │  (SSL/TLS) │   :8089       │  (Vue.js SPA) │
└──────────┘                └────────────┘               └───────┬───────┘
                                                                 │
                                                          /api/* │
                                                                 ▼
                                                         ┌───────────────┐
                                                         │ admin-wildfly │
                                                         │ (REST API)    │
                                                         │   :8085       │
                                                         └───────┬───────┘
                                                                 │
                                                          JDBC   │
                                                                 ▼
                                                         ┌───────────────┐
                                                         │    MariaDB    │
                                                         │ temco_system  │
                                                         │   :3306       │
                                                         └───────────────┘
```

## Port Mapping

| Service | Container Port | Host Port | URL |
|---------|---------------|-----------|-----|
| admin-frontend | 80 | 8089 | http://127.0.0.1:8089 |
| admin-wildfly | 8080 | 8085 | http://127.0.0.1:8085 |
| admin-wildfly (admin) | 9990 | 9992 | http://127.0.0.1:9992 |
| MariaDB (host) | - | 3306 | 172.17.0.1:3306 |

## Network Configuration

```
┌─────────────────────────────────────────────────────────────────┐
│                        Docker Network                            │
│                                                                  │
│   docker0 bridge: 172.17.0.0/16                                 │
│   Gateway (Host): 172.17.0.1                                    │
│                                                                  │
│   ┌─────────────────┐    ┌─────────────────┐                    │
│   │ admin-frontend  │    │ admin-wildfly   │                    │
│   │   172.17.0.x    │    │   172.17.0.y    │                    │
│   └────────┬────────┘    └────────┬────────┘                    │
│            │                      │                              │
│            └──────────┬───────────┘                              │
│                       │                                          │
│                       ▼                                          │
│              ┌────────────────┐                                  │
│              │  172.17.0.1    │ ◀─── Docker Gateway to Host      │
│              │  (Host Access) │                                  │
│              └────────┬───────┘                                  │
│                       │                                          │
└───────────────────────┼──────────────────────────────────────────┘
                        │
                        ▼
              ┌────────────────┐
              │  Host MariaDB  │
              │  0.0.0.0:3306  │
              └────────────────┘
```

## Key Configuration Files

| File | Location | Purpose |
|------|----------|---------|
| docker-compose.adminapp.yml | /root/adminapp-isolated/ | Container orchestration |
| admin-nginx.conf | /root/adminapp-isolated/ | Frontend nginx config |
| standalone.xml | Mounted in WildFly | WildFly/Datasource config |
| temcobank.conf | /etc/nginx/conf.d/ | Host nginx routing |

## Security

- **SSL/TLS**: Terminated at host nginx (Let's Encrypt certs)
- **JWT**: Backend authentication using io.jsonwebtoken
- **Password Hashing**: BCrypt (jbcrypt library)
- **DB Access**: Root granted only from Docker network (172.17.%)
